<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Otterseas - Customize Your Surface Tank</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-navy: #1a2e3d;
      --soft-teal: #5a9fa8;
      --light-cream: #f9f7f4;
      --warm-sand: #e8dfd3;
      --coral-accent: #d97652;
      --text-dark: #2d3e50;
      --text-light: #6b7280;
      --white: #ffffff;
      --border-light: #e0d8cc;
      --success-green: #4a9d7a;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background: var(--light-cream);
      color: var(--text-dark);
      line-height: 1.6;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle at 20% 50%, rgba(90, 159, 168, 0.03) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(217, 118, 82, 0.03) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    .app-container {
      position: relative;
      z-index: 1;
      max-width: 1400px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
    }

    .page-header {
      text-align: center;
      margin-bottom: 3rem;
      padding-bottom: 2rem;
      border-bottom: 2px solid var(--border-light);
    }

    .page-title {
      font-family: 'Playfair Display', serif;
      font-size: 3rem;
      color: var(--primary-navy);
      font-weight: 700;
      margin-bottom: 0.5rem;
      letter-spacing: -0.5px;
    }

    .page-subtitle {
      font-size: 1.1rem;
      color: var(--text-light);
      font-weight: 300;
    }

    .main-content {
      display: grid;
      grid-template-columns: 1fr 360px;
      gap: 2rem;
      align-items: start;
    }

    .left-section {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    /* Water Bottle Card */
    .water-bottle-card {
      background: var(--white);
      border: 1px solid var(--border-light);
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
      display: flex;
      align-items: center;
      gap: 2rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .water-bottle-card:hover {
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
      border-color: var(--soft-teal);
    }

    .bottle-image-container {
      flex-shrink: 0;
    }

    .bottle-image-container img {
      width: 180px;
      height: 180px;
      object-fit: contain;
    }

    .bottle-info {
      flex: 1;
    }

    .bottle-info h2 {
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem;
      color: var(--primary-navy);
      margin-bottom: 0.5rem;
    }

    .bottle-info p {
      color: var(--text-light);
      margin-bottom: 1rem;
      font-size: 0.95rem;
    }

    .bottle-price {
      font-size: 1.5rem;
      color: var(--coral-accent);
      font-weight: 600;
      margin-bottom: 1rem;
    }

    .bottle-actions {
      display: flex;
      gap: 1rem;
    }

    .btn-primary {
      background: var(--soft-teal);
      color: white;
      border: none;
      padding: 0.9rem 2rem;
      border-radius: 6px;
      font-weight: 500;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .btn-primary:hover {
      background: #4a8d95;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(90, 159, 168, 0.3);
    }

    .btn-secondary {
      background: white;
      color: var(--soft-teal);
      border: 2px solid var(--soft-teal);
    }

    .btn-secondary:hover {
      background: var(--soft-teal);
      color: white;
    }

    /* Sticker Selector */
    .sticker-selector {
      background: var(--white);
      border: 1px solid var(--border-light);
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
      min-height: 500px;
      max-height: 650px;
      display: flex;
      flex-direction: column;
    }

    .selector-header {
      margin-bottom: 1.5rem;
    }

    .selector-header h3 {
      font-family: 'Playfair Display', serif;
      font-size: 1.6rem;
      color: var(--primary-navy);
      margin-bottom: 1rem;
    }

    .tabs {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      border-bottom: 2px solid var(--border-light);
      padding-bottom: 1rem;
    }

    .tab {
      padding: 0.6rem 1.2rem;
      background: transparent;
      border: 1px solid var(--border-light);
      color: var(--text-light);
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      border-radius: 6px;
      font-family: 'Montserrat', sans-serif;
    }

    .tab:hover {
      background: var(--warm-sand);
      border-color: var(--soft-teal);
    }

    .tab.active {
      background: var(--soft-teal);
      color: white;
      border-color: var(--soft-teal);
    }

    .sticker-grid-container {
      flex: 1;
      overflow-y: auto;
      padding-right: 0.5rem;
      margin-top: 1.5rem;
    }

    .sticker-grid-container::-webkit-scrollbar {
      width: 6px;
    }

    .sticker-grid-container::-webkit-scrollbar-track {
      background: var(--light-cream);
      border-radius: 10px;
    }

    .sticker-grid-container::-webkit-scrollbar-thumb {
      background: var(--soft-teal);
      border-radius: 10px;
    }

    .sticker-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 1.25rem;
      padding-bottom: 1rem;
    }

    .sticker-card {
      background: var(--light-cream);
      border: 1px solid var(--border-light);
      border-radius: 10px;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      color: inherit;
      display: block;
    }

    .sticker-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
      border-color: var(--soft-teal);
    }

    .sticker-card img {
      width: 100%;
      height: 140px;
      object-fit: cover;
      margin-bottom: 0.75rem;
      border-radius: 6px;
    }

    .sticker-card h4 {
      font-size: 1rem;
      margin-bottom: 0.4rem;
      color: var(--primary-navy);
      font-weight: 500;
    }

    .sticker-card .region {
      font-size: 0.8rem;
      color: var(--text-light);
      margin-bottom: 0.5rem;
    }

    .sticker-card .price {
      font-size: 0.95rem;
      color: var(--coral-accent);
      font-weight: 600;
    }

    /* Bundle Section */
    .bundle-section {
      background: var(--white);
      border: 1px solid var(--border-light);
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }

    .bundle-section h3 {
      font-family: 'Playfair Display', serif;
      font-size: 1.6rem;
      color: var(--primary-navy);
      margin-bottom: 1.5rem;
    }

    .bundle-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
    }

    .bundle-card {
      background: var(--light-cream);
      border: 1px solid var(--border-light);
      border-radius: 10px;
      padding: 1.5rem;
      transition: all 0.3s ease;
      text-decoration: none;
      color: inherit;
      display: block;
      cursor: pointer;
    }

    .bundle-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
      border-color: var(--coral-accent);
    }

    .bundle-card h4 {
      font-size: 1.2rem;
      margin-bottom: 0.5rem;
      color: var(--primary-navy);
      font-weight: 600;
    }

    .bundle-description {
      font-size: 0.9rem;
      color: var(--text-light);
      margin-bottom: 0.75rem;
    }

    .bundle-count {
      font-size: 0.85rem;
      color: var(--soft-teal);
      margin-bottom: 1rem;
      font-weight: 500;
    }

    .bundle-price {
      font-size: 1.4rem;
      color: var(--coral-accent);
      font-weight: 700;
    }

    /* Cart Sidebar */
    .cart-sidebar {
      background: var(--white);
      border: 1px solid var(--border-light);
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
      position: sticky;
      top: 2rem;
      max-height: calc(100vh - 4rem);
      display: flex;
      flex-direction: column;
    }

    .cart-sidebar h2 {
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem;
      color: var(--primary-navy);
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid var(--border-light);
    }

    .cart-items {
      flex: 1;
      overflow-y: auto;
      margin-bottom: 1.5rem;
    }

    .cart-items::-webkit-scrollbar {
      width: 6px;
    }

    .cart-items::-webkit-scrollbar-track {
      background: var(--light-cream);
      border-radius: 10px;
    }

    .cart-items::-webkit-scrollbar-thumb {
      background: var(--soft-teal);
      border-radius: 10px;
    }

    .cart-item {
      background: var(--light-cream);
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 0.75rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .cart-item-info h4 {
      font-size: 0.95rem;
      margin-bottom: 0.25rem;
      color: var(--primary-navy);
      font-weight: 500;
    }

    .cart-item-info .quantity {
      font-size: 0.8rem;
      color: var(--text-light);
    }

    .cart-item-info .discounted {
      font-size: 0.75rem;
      color: var(--success-green);
      font-weight: 500;
    }

    .cart-item button {
      background: transparent;
      border: 1px solid var(--coral-accent);
      color: var(--coral-accent);
      border-radius: 4px;
      padding: 0.4rem 0.8rem;
      cursor: pointer;
      font-size: 0.8rem;
      transition: all 0.3s ease;
    }

    .cart-item button:hover {
      background: var(--coral-accent);
      color: white;
    }

    .empty-cart {
      text-align: center;
      padding: 3rem 1rem;
      color: var(--text-light);
      font-style: italic;
    }

    .cart-summary {
      border-top: 2px solid var(--border-light);
      padding-top: 1.5rem;
    }

    .pricing-tier-info {
      background: #f0f9fa;
      border: 1px solid var(--soft-teal);
      border-radius: 6px;
      padding: 0.75rem;
      margin-bottom: 1rem;
      font-size: 0.85rem;
      color: var(--text-dark);
    }

    .pricing-tier-info .tier-title {
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--soft-teal);
    }

    .pricing-tier-info .tier-details {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .pricing-tier-info .discount-amount {
      color: var(--success-green);
      font-weight: 600;
    }

    .minimum-warning {
      background: #fef3f0;
      border: 1px solid var(--coral-accent);
      border-radius: 6px;
      padding: 0.75rem;
      margin-bottom: 1rem;
      font-size: 0.85rem;
      color: var(--coral-accent);
      text-align: center;
    }

    .cart-summary-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.75rem;
      font-size: 0.95rem;
      color: var(--text-dark);
    }

    .cart-summary-row.discount {
      color: var(--success-green);
      font-weight: 500;
    }

    .cart-summary-row.total {
      font-size: 1.4rem;
      font-weight: 600;
      color: var(--primary-navy);
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 2px solid var(--border-light);
    }

    .checkout-button {
      width: 100%;
      padding: 1.2rem;
      background: var(--coral-accent);
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 1rem;
    }

    .checkout-button:hover:not(:disabled) {
      background: #c96746;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(217, 118, 82, 0.3);
    }

    .checkout-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Modal with iframe */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(26, 46, 61, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      animation: fadeIn 0.3s ease;
      padding: 2rem;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal-content {
      background: var(--white);
      border-radius: 12px;
      max-width: 900px;
      width: 100%;
      max-height: 90vh;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: slideUp 0.3s ease;
      position: relative;
      display: flex;
      flex-direction: column;
    }

    @keyframes slideUp {
      from { transform: translateY(50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .modal-header {
      padding: 1.5rem 2rem;
      border-bottom: 1px solid var(--border-light);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-header h3 {
      font-family: 'Playfair Display', serif;
      font-size: 1.5rem;
      color: var(--primary-navy);
      margin: 0;
    }

    .modal-close {
      background: transparent;
      border: 1px solid var(--border-light);
      color: var(--text-light);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      cursor: pointer;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .modal-close:hover {
      background: var(--coral-accent);
      color: white;
      border-color: var(--coral-accent);
    }

    .modal-body {
      flex: 1;
      overflow: hidden;
      position: relative;
    }

    .modal-body iframe {
      width: 100%;
      height: 100%;
      border: none;
      display: block;
    }

    .modal-footer {
      padding: 1.5rem 2rem;
      border-top: 1px solid var(--border-light);
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
    }

    .modal-footer .btn-primary {
      padding: 0.75rem 1.5rem;
    }

    @media (max-width: 1024px) {
      .main-content {
        grid-template-columns: 1fr;
      }

      .cart-sidebar {
        position: relative;
        top: 0;
        max-height: none;
      }

      .water-bottle-card {
        flex-direction: column;
        text-align: center;
      }

      .bottle-actions {
        flex-direction: column;
        width: 100%;
      }

      .bottle-actions .btn-primary,
      .bottle-actions .btn-secondary {
        width: 100%;
      }

      .page-title {
        font-size: 2.2rem;
      }

      .modal-content {
        max-width: 95%;
        max-height: 95vh;
      }
    }

    @media (max-width: 768px) {
      .sticker-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      }

      .bundle-grid {
        grid-template-columns: 1fr;
      }

      .modal-overlay {
        padding: 1rem;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    // CONFIGURATION: Update these with your actual Wix product URLs and data
    const WATER_BOTTLE = {
      id: 'water-bottle',
      name: 'The Surface Tank',
      description: 'Premium water bottle designed for divers. Double-walled vacuum insulation. 40oz capacity.',
      price: 40.00,
      wixUrl: 'https://www.otterseas.com/product-page/the-surface-tank-water-bottle-pre-sale',
      wixProductId: 'YOUR_WIX_PRODUCT_ID', // Get from Wix
      image: 'https://via.placeholder.com/180x180/1a2e3d/ffffff?text=Surface+Tank'
    };

    const STICKERS = {
      Asia: [
        { id: 'asia-raja-ampat', name: 'Raja Ampat', region: 'Asia', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/raja-ampat', wixProductId: 'YOUR_WIX_ID', image: 'https://via.placeholder.com/200x200/5a9fa8/ffffff?text=Raja+Ampat', description: 'Vibrant coral reefs in the heart of the Coral Triangle' },
        { id: 'asia-komodo', name: 'Komodo', region: 'Asia', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/komodo', wixProductId: 'YOUR_WIX_ID', image: 'https://via.placeholder.com/200x200/5a9fa8/ffffff?text=Komodo', description: 'Dramatic currents and manta encounters' },
        { id: 'asia-tubbataha', name: 'Tubbataha', region: 'Asia', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/tubbataha', wixProductId: 'YOUR_WIX_ID', image: 'https://via.placeholder.com/200x200/5a9fa8/ffffff?text=Tubbataha', description: 'UNESCO World Heritage pristine coral walls' },
      ],
      Europe: [
        { id: 'europe-malta', name: 'Malta Blue Hole', region: 'Europe', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/malta', wixProductId: 'YOUR_WIX_ID', image: 'https://via.placeholder.com/200x200/5a9fa8/ffffff?text=Malta', description: 'Mediterranean diving with dramatic formations' },
        { id: 'europe-azores', name: 'Azores', region: 'Europe', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/azores', wixProductId: 'YOUR_WIX_ID', image: 'https://via.placeholder.com/200x200/5a9fa8/ffffff?text=Azores', description: 'Pelagic encounters in the Atlantic' },
      ],
      Americas: [
        { id: 'americas-galapagos', name: 'Galápagos', region: 'Americas', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/galapagos', wixProductId: 'YOUR_WIX_ID', image: 'https://via.placeholder.com/200x200/5a9fa8/ffffff?text=Galapagos', description: 'Hammerhead sharks and unique wildlife' },
        { id: 'americas-socorro', name: 'Socorro', region: 'Americas', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/socorro', wixProductId: 'YOUR_WIX_ID', image: 'https://static.wixstatic.com/media/5c0d7c_abea2be15a684e9a943b7915585da8d1~mv2.jpg/v1/fill/w_1102,h_1102,al_c,q_85,usm_0.66_1.00_0.01,enc_avif,quality_auto/5c0d7c_abea2be15a684e9a943b7915585da8d1~mv2.jpg', description: 'Giant manta interactions' },
        { id: 'americas-socorro', name: 'Socorro', region: 'Americas', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/socorro', wixProductId: 'YOUR_WIX_ID', image: 'https://via.placeholder.com/200x200/5a9fa8/ffffff?text=Socorro', description: 'Giant manta interactions' },
        { id: 'americas-socorro', name: 'Socorro', region: 'Americas', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/socorro', wixProductId: 'YOUR_WIX_ID', image: 'https://via.placeholder.com/200x200/5a9fa8/ffffff?text=Socorro', description: 'Giant manta interactions' },
        { id: 'americas-socorro', name: 'Socorro', region: 'Americas', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/socorro', wixProductId: 'YOUR_WIX_ID', image: 'https://via.placeholder.com/200x200/5a9fa8/ffffff?text=Socorro', description: 'Giant manta interactions' },
        { id: 'americas-socorro', name: 'Socorro', region: 'Americas', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/socorro', wixProductId: 'YOUR_WIX_ID', image: 'https://via.placeholder.com/200x200/5a9fa8/ffffff?text=Socorro', description: 'Giant manta interactions' },
      ],
      Oceania: [
        { id: 'oceania-gbr', name: 'Great Barrier Reef', region: 'Oceania', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/great-barrier-reef', wixProductId: 'YOUR_WIX_ID', image: 'https://via.placeholder.com/200x200/5a9fa8/ffffff?text=GBR', description: 'World\'s largest coral reef system' },
        { id: 'oceania-palau', name: 'Palau', region: 'Oceania', basePrice: 3.50, wixUrl: 'https://www.otterseas.com/product-page/palau', wixProductId: 'YOUR_WIX_ID', image: 'https://via.placeholder.com/200x200/5a9fa8/ffffff?text=Palau', description: 'Jellyfish Lake and blue corners' },
      ],
    };

    const BUNDLES = [
      { id: 'bundle-tropical', name: 'Tropical Explorer Pack', description: 'Warm water favorites from around the globe', count: 8, price: 25.00, wixUrl: 'https://www.otterseas.com/product-page/tropical-bundle', wixProductId: 'YOUR_WIX_ID' },
      { id: 'bundle-pacific', name: 'Pacific Paradise Pack', description: 'Best of the Pacific Ocean', count: 10, price: 32.00, wixUrl: 'https://www.otterseas.com/product-page/pacific-bundle', wixProductId: 'YOUR_WIX_ID' },
    ];

    // Discount tiers: basePrice minus discount
    const DISCOUNT_TIERS = [
      { min: 5, max: 9, discount: 0.35 },   // £3.50 - £0.35 = £3.15
      { min: 10, max: Infinity, discount: 0.55 },  // £3.50 - £0.55 = £2.95
    ];

    function StickerSelector() {
      const [activeTab, setActiveTab] = useState('Asia');
      const [cart, setCart] = useState([]);
      const [modalContent, setModalContent] = useState(null);

      const addToCart = (item, isBundle = false, isBottle = false) => {
        setCart(prev => {
          const existing = prev.find(i => i.id === item.id);
          if (existing) {
            return prev.map(i => 
              i.id === item.id ? { ...i, quantity: i.quantity + 1 } : i
            );
          }
          return [...prev, { ...item, quantity: 1, isBundle, isBottle }];
        });
        setModalContent(null);
      };

      const removeFromCart = (id) => {
        setCart(prev => prev.filter(item => item.id !== id));
      };

      const getStickerCount = () => {
        return cart.reduce((total, item) => {
          if (!item.isBundle && !item.isBottle) {
            return total + item.quantity;
          }
          return total;
        }, 0);
      };

      const getCurrentDiscount = () => {
        const count = getStickerCount();
        const tier = DISCOUNT_TIERS.find(t => count >= t.min && count <= t.max);
        return tier ? tier.discount : 0;
      };

      const calculateSubtotal = () => {
        let total = 0;
        cart.forEach(item => {
          if (item.isBundle || item.isBottle) {
            total += item.price * item.quantity;
          } else {
            total += item.basePrice * item.quantity;
          }
        });
        return total;
      };

      const calculateDiscount = () => {
        const discount = getCurrentDiscount();
        const stickerCount = getStickerCount();
        return discount * stickerCount;
      };

      const calculateTotal = () => {
        return (calculateSubtotal() - calculateDiscount()).toFixed(2);
      };

      const canCheckout = () => {
        const stickerCount = getStickerCount();
        return stickerCount >= 5 || cart.some(item => item.isBundle);
      };

      const handleCheckout = () => {
        // Prepare cart data for Wix integration
        const cartData = {
          items: cart.map(item => ({
            productId: item.wixProductId,
            quantity: item.quantity,
            name: item.name,
            price: item.isBundle || item.isBottle ? item.price : (item.basePrice - getCurrentDiscount())
          })),
          subtotal: calculateSubtotal(),
          discount: calculateDiscount(),
          total: calculateTotal(),
          discountTier: getCurrentDiscount() > 0 ? `${getStickerCount()} stickers - £${getCurrentDiscount().toFixed(2)} off each` : null
        };

        // Save to sessionStorage for Wix to retrieve
        sessionStorage.setItem('otterseas_cart', JSON.stringify(cartData));
        
        // Option 1: Redirect to Wix with cart data in URL
        const cartParams = encodeURIComponent(JSON.stringify(cartData));
        window.location.href = `https://www.otterseas.com/cart-handler?data=${cartParams}`;
        
        // Option 2: Show instructions (for testing)
        // alert(`Cart prepared! ${cart.length} items\nTotal: £${calculateTotal()}\n\nIn production, this will redirect to your Wix store with all items added to cart.`);
        // console.log('Cart data for Wix:', cartData);
      };

      const openProductModal = (item, isBundle = false, isBottle = false) => {
        setModalContent({
          ...item,
          isBundle,
          isBottle
        });
      };

      return (
        <div className="app-container">
          <header className="page-header">
            <h1 className="page-title">Customize Your Surface Tank</h1>
            <p className="page-subtitle">Select stickers from your favorite dive destinations</p>
          </header>

          <div className="main-content">
            <div className="left-section">
              {/* Water Bottle */}
              <div className="water-bottle-card" onClick={() => openProductModal(WATER_BOTTLE, false, true)}>
                <div className="bottle-image-container">
                  <img src={WATER_BOTTLE.image} alt={WATER_BOTTLE.name} />
                </div>
                <div className="bottle-info">
                  <h2>{WATER_BOTTLE.name}</h2>
                  <p>{WATER_BOTTLE.description}</p>
                  <div className="bottle-price">£{WATER_BOTTLE.price.toFixed(2)}</div>
                  <div className="bottle-actions">
                    <button 
                      className="btn-primary btn-secondary" 
                      onClick={(e) => { e.stopPropagation(); addToCart(WATER_BOTTLE, false, true); }}
                    >
                      Add to Selection
                    </button>
                    <button 
                      className="btn-primary" 
                      onClick={(e) => { e.stopPropagation(); openProductModal(WATER_BOTTLE, false, true); }}
                    >
                      View Details
                    </button>
                  </div>
                </div>
              </div>

              {/* Sticker Selector */}
              <div className="sticker-selector">
                <div className="selector-header">
                  <h3>Choose Your Stickers</h3>
                  <div className="tabs">
                    {Object.keys(STICKERS).map(region => (
                      <button
                        key={region}
                        className={`tab ${activeTab === region ? 'active' : ''}`}
                        onClick={() => setActiveTab(region)}
                      >
                        {region}
                      </button>
                    ))}
                  </div>
                </div>

                <div className="sticker-grid-container">
                  <div className="sticker-grid">
                    {STICKERS[activeTab].map(sticker => (
                      <div key={sticker.id} className="sticker-card" onClick={() => openProductModal(sticker)}>
                        <img src={sticker.image} alt={sticker.name} />
                        <h4>{sticker.name}</h4>
                        <div className="region">{sticker.region}</div>
                        <div className="price">£{sticker.basePrice.toFixed(2)}</div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>

              {/* Bundles */}
              <div className="bundle-section">
                <h3>Pre-Selected Bundles</h3>
                <div className="bundle-grid">
                  {BUNDLES.map(bundle => (
                    <div key={bundle.id} className="bundle-card" onClick={() => openProductModal(bundle, true)}>
                      <h4>{bundle.name}</h4>
                      <div className="bundle-description">{bundle.description}</div>
                      <div className="bundle-count">{bundle.count} stickers included</div>
                      <div className="bundle-price">£{bundle.price.toFixed(2)}</div>
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {/* Cart */}
            <aside className="cart-sidebar">
              <h2>Your Selection</h2>

              <div className="cart-items">
                {cart.length === 0 ? (
                  <div className="empty-cart">No items selected yet</div>
                ) : (
                  cart.map(item => (
                    <div key={item.id} className="cart-item">
                      <div className="cart-item-info">
                        <h4>{item.name}</h4>
                        <div className="quantity">
                          Qty: {item.quantity}
                          {item.isBundle && ` (${item.count} stickers)`}
                        </div>
                        {!item.isBundle && !item.isBottle && getCurrentDiscount() > 0 && (
                          <div className="discounted">
                            -£{getCurrentDiscount().toFixed(2)} discount applied
                          </div>
                        )}
                      </div>
                      <button onClick={() => removeFromCart(item.id)}>Remove</button>
                    </div>
                  ))
                )}
              </div>

              <div className="cart-summary">
                {getStickerCount() >= 5 && (
                  <div className="pricing-tier-info">
                    <div className="tier-title">Volume Discount Active!</div>
                    <div className="tier-details">
                      <div>{getStickerCount()} stickers selected</div>
                      <div className="discount-amount">
                        £{getCurrentDiscount().toFixed(2)} off per sticker
                      </div>
                    </div>
                  </div>
                )}

                {getStickerCount() > 0 && getStickerCount() < 5 && (
                  <div className="minimum-warning">
                    Add {5 - getStickerCount()} more sticker{5 - getStickerCount() !== 1 ? 's' : ''} to unlock discounts
                  </div>
                )}

                <div className="cart-summary-row">
                  <span>Subtotal:</span>
                  <span>£{calculateSubtotal().toFixed(2)}</span>
                </div>

                {getCurrentDiscount() > 0 && (
                  <div className="cart-summary-row discount">
                    <span>Volume Discount:</span>
                    <span>-£{calculateDiscount().toFixed(2)}</span>
                  </div>
                )}

                <div className="cart-summary-row total">
                  <span>Total:</span>
                  <span>£{calculateTotal()}</span>
                </div>

                <button 
                  className="checkout-button" 
                  disabled={!canCheckout()}
                  onClick={handleCheckout}
                >
                  Continue to Checkout
                </button>
              </div>
            </aside>
          </div>

          {/* Product Page Modal */}
          {modalContent && (
            <div className="modal-overlay" onClick={() => setModalContent(null)}>
              <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                <div className="modal-header">
                  <h3>{modalContent.name}</h3>
                  <button className="modal-close" onClick={() => setModalContent(null)}>×</button>
                </div>
                <div className="modal-body">
                  <iframe 
                    src={modalContent.wixUrl} 
                    title={modalContent.name}
                    allow="payment"
                  />
                </div>
                <div className="modal-footer">
                  <button 
                    className="btn-primary btn-secondary" 
                    onClick={() => addToCart(modalContent, modalContent.isBundle, modalContent.isBottle)}
                  >
                    Add to Selection
                  </button>
                  <button 
                    className="btn-primary" 
                    onClick={() => window.open(modalContent.wixUrl, '_blank')}
                  >
                    Open in New Tab
                  </button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.render(<StickerSelector />, document.getElementById('root'));
  </script>
</body>
</html>
